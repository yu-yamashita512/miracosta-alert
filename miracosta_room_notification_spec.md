### ミラコスタ空室通知サービス仕様書（国内向け）

---

## 1. サービス概要
- **目的**：東京ディズニーシー直結ホテル「ミラコスタ」の空室情報を、ユーザーがリアルタイムで確認・通知を受けられるサービス
- **対象ユーザー**：国内ディズニーファン・ガチ勢（年数回〜年数十回リピーター、ホテル宿泊意欲が高い層）
- **提供価値**：
  1. 空室が出た瞬間に通知（LINE / メール）
  2. Web上で空室状況を即確認
  3. 課金プランでプレミアム通知や日付・部屋タイプ指定

---

## 2. プラットフォーム構成
| 要素 | 選定理由 |
|------|---------|
| フロントエンド | Next.js + Vercel：高速・リアルタイム表示・サーバレスAPI対応 |
| バックエンド / DB | Supabase：ユーザー認証、空室情報キャッシュ、通知条件管理 |
| 通知 | LINE Notify（任意）、メール通知（SMTP or SendGrid等） |
| 定期監視 | Supabase Functions（5分間隔監視） |

---

## 3. 機能一覧
### 3-1. ユーザー管理
- メール/パスワードで登録・ログイン
- 課金プラン選択（サブスク）
- 通知条件設定（部屋タイプ、日付）

### 3-2. 空室監視・通知
- 定期監視：5分間隔で公式サイトを確認
- 空室検知：空室が出た場合、DBに反映
- 通知トリガー：LINE Notify、メール
- 通知条件：ユーザー指定の条件に応じて通知

### 3-3. Webフロント
- 空室カレンダー・一覧表示
- 過去通知履歴表示
- 課金プラン確認・変更
- ユーザー情報管理

---

## 4. 技術仕様
| 技術 | 用途 |
|------|-----|
| Next.js | フロント＋APIルートで簡易バックエンド |
| Vercel | Web公開・サーバレス関数実行 |
| Supabase DB | 空室情報キャッシュ、ユーザー・通知条件管理 |
| Supabase Functions | 5分間隔監視、空室取得、通知処理 |
| LINE Notify | 即時通知 |
| SMTP / SendGrid | メール通知 |

---

## 5. 法務・運用注意点
- 公式利用規約遵守：過剰スクレイピングや自動化アクセスは禁止回避
- 通知頻度制御：5分間隔程度に抑える
- 収益化：国内ユーザー向け月額サブスク（例：980円／月）
- 個人情報管理：ユーザーデータ・メール・LINEトークンの安全管理

---

## 6. 収益モデル（国内）
- 初期ターゲット：約10万人（無料登録者）
- 課金率：初期1〜5％、安定後5〜10％
- 月額課金例：980円／ユーザー
- 月収見込み：
  - 初期：10万円前後
  - 成長期：100〜150万円
  - 安定期：月数百万円も可能

---

## 7. MVPロードマップ（国内向け）
| フェーズ | 期間 | タスク |
|-----------|------|--------|
| 設計・準備 | 1〜2週間 | DB設計、通知フロー設計、Supabaseアカウント作成 |
| 監視機能実装 | 2週間 | Supabase Functionsで空室監視、DBキャッシュ |
| フロント構築 | 2週間 | Next.jsで空室一覧・通知設定UI構築、Vercel公開 |
| 通知連携 | 1週間 | LINE Notify・メール通知テスト |
| MVPリリース | 1週間 | 少人数でベータ配布、フィードバック取得 |
| 課金機能追加 | 2週間 | サブスク課金導入（Stripe等）、フル公開

---

## 8. システム構成図 / 処理フロー
```
[東京ディズニーシー ミラコスタ公式ページ]
           │
           ▼
   ┌─────────────────────┐
   │  Supabase Functions  │
   │  (定期監視 / 5分間隔) │
   │  - 空室情報取得       │
   │  - DBにキャッシュ     │
   │  - ユーザー条件照合   │
   └─────────────────────┘
           │
           ▼
   ┌─────────────────────┐
   │     Supabase DB      │
   │  - 空室情報キャッシュ │
   │  - ユーザー情報管理   │
   │  - 通知条件管理       │
   └─────────────────────┘
           │
           ├───────────────┐
           │               │
           ▼               ▼
   ┌─────────────┐   ┌─────────────┐
   │  LINE Notify │   │   メール通知 │
   │ - 即時通知   │   │ - 即時通知   │
   └─────────────┘   └─────────────┘
           │
           ▼
   ┌─────────────────────┐
   │   Next.js フロント    │
   │  (Vercelで公開)      │
   │ - 空室一覧表示        │
   │ - 通知履歴表示        │
   │ - ユーザー登録/ログイン │
   │ - 課金プラン管理       │
   └─────────────────────┘
           │
           ▼
        [ユーザー]
   - Webで空室確認
   - LINE/メールで即時通知受信
```

